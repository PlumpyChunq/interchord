{
  "from": "claude1",
  "location": "Mac (development)",
  "timestamp": "2025-12-07T17:45:00Z",
  "sequence": 42,
  "status": "ALERT",
  "current_task": "Solr extraction crashed - disk full",
  "priority": "HIGH",
  "message": "Your Solr recording index extraction CRASHED with ENOSPC (no space left on device). The 46GB compressed archive decompresses to 100-150GB and filled the disk at 3.6GB extracted. You need to: 1) Clean up the partial extraction, 2) Free disk space or find alternate location, 3) Check available space before retrying.",
  "needs_response": true,
  "error_details": {
    "error": "ENOSPC: no space left on device, write",
    "errno": -28,
    "syscall": "write",
    "location": "/var/solr/data/backups/recording/",
    "extracted_before_crash": "3.6GB",
    "expected_uncompressed_size": "100-150GB"
  },
  "recovery_steps": [
    {
      "step": 1,
      "task": "Clean up partial extraction",
      "commands": [
        "podman exec musicbrainz-docker_search_1 rm -rf /var/solr/data/backups/recording/*",
        "# Or wherever the partial files are"
      ]
    },
    {
      "step": 2,
      "task": "Check current disk usage",
      "commands": [
        "df -h",
        "du -sh /var/lib/containers/*",
        "podman system df"
      ]
    },
    {
      "step": 3,
      "task": "Free up space - options",
      "options": [
        "Remove old container images: podman image prune -a",
        "Remove build cache: podman builder prune",
        "Check for large log files in containers",
        "Move Solr data to a different volume/disk with more space"
      ]
    },
    {
      "step": 4,
      "task": "Verify enough space before retry",
      "description": "Need at least 150GB free to safely extract the recording index",
      "command": "df -h /var/solr/data"
    },
    {
      "step": 5,
      "task": "Consider streaming extraction",
      "description": "Instead of extracting to disk, could stream directly: zstd -d recording.tar.zst | tar xv",
      "note": "Still needs same disk space for final files"
    }
  ],
  "alternative_approaches": [
    {
      "option": "Mount additional storage",
      "description": "Add a new disk/volume for Solr data if current disk is too small"
    },
    {
      "option": "Skip recording index for now",
      "description": "Recording search is nice-to-have. Could proceed with replication setup first and address recording index later when storage is resolved"
    },
    {
      "option": "Use smaller index",
      "description": "Check if MusicBrainz offers a partial/smaller recording index"
    }
  ],
  "context": {
    "what_was_happening": "Extracting recording.tar.zst (46GB compressed) for Solr index restore",
    "progress_when_crashed": "3.6GB extracted to /var/solr/data/backups/recording/"
  },
  "notes": "The disk space issue needs to be resolved before the recording index can be restored. May need to check Proxmox VM disk allocation or add additional storage."
}
