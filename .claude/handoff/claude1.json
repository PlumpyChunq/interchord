{
  "from": "claude1",
  "location": "mac",
  "timestamp": "2025-12-12T20:15:00Z",
  "sequence": 69,
  "status": "DEPLOY_REQUEST",
  "task": "Deploy Solr XML parsing + Genre enrichment fix",
  "message": "Two fixes: (1) Album/Song searches now work - MusicBrainz Solr stores data as XML in _store field, added parsing. (2) Genre enrichment - favorites now get genres from PostgreSQL tags when viewing artist detail. All favorites will update from 'Other' category to proper genres.",
  "needs_response": true,
  "priority": "HIGH",
  "action_required": {
    "task": "Pull and rebuild to test both fixes",
    "commands": [
      "cd ~/interchord && git pull origin main",
      "podman-compose down",
      "podman-compose up -d --build",
      "sleep 15 && podman-compose logs --tail 30"
    ],
    "verification": [
      "curl -s http://localhost:3000/api/musicbrainz/health | jq .",
      "curl -s 'http://localhost:3000/api/autocomplete?q=Locus&type=release&limit=3' | jq '.results[:2]'",
      "curl -s 'http://localhost:3000/api/autocomplete?q=Yesterday&type=recording&limit=3' | jq '.results[:2]'"
    ]
  },
  "context": {
    "key_files": [
      "src/lib/musicbrainz/solr-client.ts - XML parsing for _store field",
      "src/lib/musicbrainz/db-client.ts - Tag/genre fetching from PostgreSQL",
      "src/lib/favorites/utils.ts - enrichFavoriteGenres() function",
      "src/components/artist-detail.tsx - Calls enrichFavoriteGenres on load"
    ],
    "changes_summary": [
      "Solr XML parsing: parseReleaseXml(), parseRecordingXml(), etc.",
      "DB client: getArtistTagsFromDB(), mapTagsToGenres(), GENRE_CATEGORIES",
      "getArtistFromDB() now returns genres from MusicBrainz tags",
      "Artist detail view enriches favorites with genres when loaded"
    ],
    "fixes_issues": [
      "Album/Song search showing icons but no titles",
      "Favorites all grouped in 'Other' category instead of proper genres"
    ],
    "prerequisites": [],
    "warnings": []
  },
  "environment": {
    "required_vars": [],
    "required_tools": ["podman", "podman-compose"]
  },
  "notes": "SPOTIFY REDIRECT ISSUE: When testing Spotify OAuth locally, use http://127.0.0.1:3000 instead of http://localhost:3000. Genre enrichment happens when user views artist detail - favorites added via autocomplete will be enriched when clicked."
}
